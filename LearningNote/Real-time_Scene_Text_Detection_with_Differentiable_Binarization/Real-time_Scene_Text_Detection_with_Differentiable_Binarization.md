# Real-time Scene Text Detection with Differentiable Binarization

- 词短句翻译

  differentiable：可微的，微分的

  threshold：阈值

  benchmark：基准

  in term of：在……方面

  tradeoff：权衡，折中 
  
  procedure：程序
  
  heuristic：启发式的，先验规则的
  
  consistently：一致地
  
  mechanism：机制
  
  rotation-invariant：旋转不变量
  
  decouple：解耦，分离
  
  decomposition：分解
  
  embed：嵌入
  
  cluster：聚集
  
  Methodology：方法论

## Abstract

近年来，由于分割结果能够更加准确的刻画多形状文本譬如弯曲文本，因而基于分割的文本检测方法非常受欢迎。但是需要注意的是，二值化的后处理在基于分割的检测中非常的重要，它能够将分割网络得到的概率图转化为文本边界框或是文本区域。在本文中，我们提出了一种叫做微分二值化（DB）的方法，它能够在分割网络中发挥二值化处理的作用。通过训练时一起优化微分二值化模块，分割网络能够自适应地设置二值化的阈值，这样不仅能够简化后处理同时还能增强文本检测的能力。我们将DB模块搭载在一个简单的分割模块上并在五个基准数据集上进行了测试，在检测准确度及速率上都获得了极好的结果。值得一提的是（In particular），轻量级的主干网络结合DB模块后表现提升极大，这为我们提供了一个能兼顾检测准确度和效果的方法。特别地（Specifically），使用ResNet-18为主干网络，结合DB模块，我们在MSRA-TD500数据集上以62FPS的速率达到了82.8的F-measure。

## Introduction

近年，从场景图片中提取文字是一个具有活力的领域，它在多领域都有用武之地，如图像/视频理解，视频搜索，自动驾驶以及盲人辅助等。

作为场景文本阅读的重要组成部分，用于找到文本检测框或是文本实例区域的场景文字检测仍然是一个非常有挑战性的任务，因为场景文字往往有多样的尺寸和样子，比如水平，多方向，或是弯曲的文本。近期，基于分割的文本检测备受关注，由于它的预测结果是像素级的能够很好的刻画多样的文本。但是大多数的基于分割的方法都需要复杂的后处理将像素级的预测转化为被检测的文本实例，这导致在推理过程中需要花费大量的时间。以当前最为先进的文本检测方法为例子：

- PSENet，提出了渐进式尺度扩展的后处理方法来提高后处理的准确度
- Pixel Embedding（像素嵌入），则是需要计算像素间的特征距离，进而更鼓分割结果，对像素进行聚类操作

大多数现有的检测方法有着类似的后处理流程，如下图中的蓝色箭头：

![image-20201031112659011](assets/image-20201031112659011.png)

传统流程：

1. 将分割网络的输出概率图按设定的阈值转化为二进制图片
2. 利用一些先验规则将像素聚类为文本实例

而我们的流程（上图中的红色过程），我们在第二步中将二值化操作添加到分割网络中，进行联结优化。以这种方式，图上的每一位位置的阈值可以自适应的被调整预测，进而完全区分前景和背景。但是标准的二值化方式并不可微，因此我们提出了另一种二值化近似法——微分二值化（DB），它在分割网络的训练过程中是完全可微的。

本文的主要贡献是提出了能够在CNN网络中实现可训练的端到端二值化处理。通过嘉禾语义分割的简单网络和我们提出的DB模块，我们提出了强健而快速的场景文本检测器。从使用DB模型的表现看（Observed from the performance evaluation of us- ing the DB module），我们认为我们的检测器和当前最先进的基于分割的方法相比，优点如下：

1. 我们的方法在五个场景文本基准数据集上**都**获得了很好的表现（Our method achieves **consistently** better performances on five benchmark datasets of scene text），包括水平、多方向以及弯曲文本。
2. DB模块能够提供更加具有鲁棒特性的二进制图，能大幅度简化后处理的进程，因此我们的方法比以前的主流方法更加快
3. DB模块在轻量级的主干网络中同样能够工作地很好，尤其在ResNet-18网络中极大的优化了他的检测表现
4. 由于DB模块能够在推导阶段可以移除但不用损失任何性能，因此在测试阶段，这并没有额外的开销

## Related Work

近期的场景文本检测的方法可以被粗略的划分为如下两种策略：基于回归的方法以及基于分割的方法。

**基于回归的方法**：有如下一系列直接回归文本实例的检测框的方法

- TextBoxes：在SSD的基础上对先验框和卷积核的尺寸进行了修改

- TextBoxes++和DMPNet：使用四边形回归检测多方向性的文本

- SSTD：提出了一种注意力机制粗略的区分文本区域

- PRD：就将文本分类和文本区域回归分离，分别使用旋转不变特征进行文本分类，旋转相关量进行文本区域回归，在多方向和长文本检测中获得了更好的效果

- EAST和DeepReg：是anchor-free的方法，基于像素级对多方向文本实例回归

  anchor-free和anchor-based的区别是，前者没有先验框的预设，或是keypoint-based，或是pixel-wise prediction，对于检测框进行预测，而anchor-based会是在先验框的基础上对各个不同大小的先验框进行回归调整，获得最终结果（这两者方法的区别还需要进一步学习）

- SegLink：回归分割边框，然后预测边框之间的联系，进而解决长文本的检测

- DeRPN：提出了维度分解区域提取网络（dimensiondecomposition region proposal network），去解决场景文本尺度问题

基于回归的方法往往不需要复杂的后处理算法，但是他们往往在不规则形状文本（譬如弯曲文本）检测方面有很大的局限性。

**基于分割的方法**：结合像素级的预测和后处理算法然后取得检测框

- 通过语义分割和MSER-based算法（最大稳定极值区域）检测多方向文本
- 使用文本边框区分文本实例
- Mask TextSpotter：在Mask-RCNN的基础上使用实例分割的方法检测形状多样的文本实例
- PSENet：提出了基于使用不同尺度卷积核获得的分割图的渐进式尺度扩展检测（有兴趣可以去看看）
- Pixel embedding：在分割的基础上对像素进行聚类
- PSENet和SAE：提出了一种新的后处理算法，处理分割结果，但是推导速度缓慢

而我们的方法专注于将二值化处理加入到寻来你时期优化分割结果，同时不用额外的开销，不必损失推断的速度。

**Fast scene text detection methods**：兼顾准确度和推导速度

- TextBoxes，TextBoxes++，SegLink，RPD都在SSD检测结构上实现了快速的文本检测
- EAT则是提出了使用PVANat提升自身的速度

但是他们大多数都没能解决不规则形状的文本（譬如弯曲文本）检测。与之前提及的快速的文本检测其相比，我们的方法不仅运行更加快速而且能够检测任意形状的文本内容。

## Methodology

网络结构如下：

![image-20201107182804001](assets/image-20201107182804001.png)

**首先**：输入图片会被喂入到特征金字塔主干网络中

**然后**：金字塔特征会通过上采样变成相同维度，级联后得到新特征$F$

**之后**：特征$F$会被同时用于预测概率图$P$和阈值图$T$

**接下来**：利用$P$和$F$计算获得近似二进制图$\hat{B}$

**在训练期间**：通过监督学习获得概率图，阈值图和近似二进制图，概率图和近似二进制图享受同等的监督（原文“In the training period, the supervision is applied on the probability map, the threshold map, and the approximate binary map, where the probability map and the approximate binary map share the same supervision”这部分的理解还是没有很到位）

**推论阶段**：通过近似二进制图或是方框公式模块组成的概率图获得检测框

### Binarization

**Standard binarization**：分割网络得到了一个概率图$P \in R^{H \times W}$，$H$和$W$代表概率图的高和宽，进而在此基础上将概率图转化为二进制图像，二进制图像上所有值为1的像素点被视为有效文本区域。通常二值化过程可以用如下公式描述：
$$
B_{i,j} = 
\begin{cases}
1 & if \ P_{i,j} \geq t, \\ 
0 & otherwise.
\end{cases}
$$
$t$是预先定义的阈值而$(i,j)$则是`map`中对应的点坐标

**Differentiable binarization**：公式1的标准二值化过程并不是可微的，因此他无法在分割网络的训练过程中进行优化。为了解决这一问题，我们提出了一种近似法来实现二值化，公式如下：
$$
\hat{B}_{i,j} = \frac{1}{1+e^{-k(P_{i,j}-T_{i,j})}}
$$
$\hat{B}$，代表近似二进制图

$T$代表网络中学习的自适应阈值图

$k$：影响因子，经验所得设置为50

近似二值化函数与标准二值化函数行为相似，但可以微分，因此它能够在分割网络的训练过程中进行优化。可微分的二值化过程和可变的阈值不仅有助于区分文本区域和背景，同时也能将区分紧密连接的文本实例



